!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t){window.onerror=function(e){var t=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}(e);"WebGL not supported"==t&&(t='Your browser does not support WebGL.<br>Please see    <a href="http://www.khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">    Getting a WebGL Implementation</a>.');var n=document.getElementById("loading");n.innerHTML=t,n.style.zIndex=1};var n,a,o,r,i,u,c,d,s=GL.create(),l=-25,p=-200.5,m=!1,h=!1;window.onload=function(){var e=window.devicePixelRatio||1,t=document.getElementById("help");function y(){var n=innerWidth-t.clientWidth-20,a=innerHeight;s.canvas.width=n*e,s.canvas.height=a*e,s.canvas.style.width=n+"px",s.canvas.style.height=a+"px",s.viewport(0,0,s.canvas.width,s.canvas.height),s.matrixMode(s.PROJECTION),s.loadIdentity(),s.perspective(45,s.canvas.width/s.canvas.height,.01,100),s.matrixMode(s.MODELVIEW),B()}if(document.body.appendChild(s.canvas),s.clearColor(0,0,0,1),n=new Water,o=new Renderer,a=new Cubemap({xneg:document.getElementById("xneg"),xpos:document.getElementById("xpos"),yneg:document.getElementById("ypos"),ypos:document.getElementById("ypos"),zneg:document.getElementById("zneg"),zpos:document.getElementById("zpos")}),!n.textureA.canDrawTo()||!n.textureB.canDrawTo())throw new Error("Rendering to floating-point textures is required but not supported");r=i=new GL.Vector(-.4,-.75,.2),u=new GL.Vector,c=new GL.Vector(0,-4,0),d=.25;for(var g=0;g<20;g++)n.addDrop(2*Math.random()-1,2*Math.random()-1,.03,1&g?.01:-.01);document.getElementById("loading").innerHTML="",y();var f,w,v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(e){setTimeout(e,0)},b=(new Date).getTime();v((function e(){var t=(new Date).getTime();h||(!function(e){if(e>1)return;if(2*e,L==I)u=new GL.Vector;else if(m){var t=Math.max(0,Math.min(1,(d-r.y)/(2*d)));u=(u=u.add(c.multiply(e-1.1*e*t))).subtract(u.unit().multiply(t*e*u.dot(u))),(r=r.add(u.multiply(e))).y<d-1&&(r.y=d-1,u.y=.7*Math.abs(u.y))}n.moveSphere(i,r,d),i=r,n.stepSimulation(),n.stepSimulation(),n.updateNormals(),o.updateCaustics(n)}((t-b)/1e3),B()),b=t,v(e)})),window.onresize=y;var x,M,L=-1,E=0,I=1,T=2;function G(t,n){x=t,M=n;var a=new GL.Raytracer,o=a.getRayForPixel(t*e,n*e),i=a.eye.add(o.multiply(-a.eye.y/o.y)),u=GL.Raytracer.hitTestSphere(a.eye,o,r,d);u?(L=I,f=u.hit,w=a.getRayForPixel(s.canvas.width/2,s.canvas.height/2).negative()):Math.abs(i.x)<1&&Math.abs(i.z)<1?(L=E,P(t,n)):L=T}function P(t,a){switch(L){case E:var i=(c=new GL.Raytracer).getRayForPixel(t*e,a*e),u=c.eye.add(i.multiply(-c.eye.y/i.y));n.addDrop(u.x,u.z,.03,.01),h&&(n.updateNormals(),o.updateCaustics(n));break;case I:i=(c=new GL.Raytracer).getRayForPixel(t*e,a*e);var c,s=-w.dot(c.eye.subtract(f))/w.dot(i),m=c.eye.add(i.multiply(s));(r=r.add(m.subtract(f))).x=Math.max(d-1,Math.min(1-d,r.x)),r.y=Math.max(d-1,Math.min(10,r.y)),r.z=Math.max(d-1,Math.min(1-d,r.z)),f=m,h&&o.updateCaustics(n);break;case T:p-=t-x,l-=a-M,l=Math.max(-89.999,Math.min(89.999,l))}x=t,M=a,h&&B()}function R(){L=-1}function _(e){return e===t||e.parentNode&&_(e.parentNode)}document.onmousedown=function(e){_(e.target)||(e.preventDefault(),G(e.pageX,e.pageY))},document.onmousemove=function(e){P(e.pageX,e.pageY)},document.onmouseup=function(){R()},document.ontouchstart=function(e){1!==e.touches.length||_(e.target)||(e.preventDefault(),G(e.touches[0].pageX,e.touches[0].pageY))},document.ontouchmove=function(e){1===e.touches.length&&P(e.touches[0].pageX,e.touches[0].pageY)},document.ontouchend=function(e){0==e.touches.length&&R()},document.onkeydown=function(e){e.which==" ".charCodeAt(0)?h=!h:e.which=="G".charCodeAt(0)?m=!m:e.which=="L".charCodeAt(0)&&h&&B()};function B(){GL.keys.L&&(o.lightDir=GL.Vector.fromAngles((90-p)*Math.PI/180,-l*Math.PI/180),h&&o.updateCaustics(n)),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.loadIdentity(),s.translate(0,0,-4),s.rotate(-l,1,0,0),s.rotate(-p,0,1,0),s.translate(0,.5,0),s.enable(s.DEPTH_TEST),o.sphereCenter=r,o.sphereRadius=d,o.renderCube(),o.renderWater(n,a),o.renderSphere(),s.disable(s.DEPTH_TEST)}}}]);
//# sourceMappingURL=bundle.js.map